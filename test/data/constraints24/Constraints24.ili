INTERLIS 2.4;

MODEL Constraints AT "mailto:ceis@localhost" VERSION "2023-09-05" =

	DOMAIN
    LKoord = COORD
        2460000.000 .. 2870000.000 [INTERLIS.m],
        1045000.000 .. 1310000.000 [INTERLIS.m],
        ROTATION 2 -> 1;

	TOPIC TopicA =
	
    	CLASS AdditionalConstraint =
      		attr1 : 0..10;
			attr2 : 0..10;
    	END AdditionalConstraint;
    	
		CLASS ConditionClass =
			attr1 : TEXT*10;
		END ConditionClass;
		
		CLASS ExistenceConstraint =
			attr1 : TEXT*10;
			!!EXISTENCE CONSTRAINT attr1 REQUIRED IN Constraints.TopicA.ConditionClass : attr1;
		END ExistenceConstraint;

		CLASS MandatoryConstraint =
			attr1 : TEXT*10;
      		attr2 : TEXT*10;
			!!MANDATORY CONSTRAINT attr1 == attr2;
		END MandatoryConstraint;
		
		CLASS PlausibilityConstraint =
			attr1 : 0..10;
			attr2 : 0..10;
			!!CONSTRAINT >= 90% attr1 < attr2;
		END PlausibilityConstraint;

		CLASS Class1 =
			attr1: (a, b, c);
			!!SET CONSTRAINT WHERE attr1 == #a : INTERLIS.objectCount(ALL) == 2;
		END Class1;
		
		CLASS UniqueConstraint =
			attr1 : TEXT*10;
			UNIQUE attr1;
		END UniqueConstraint;

		CLASS Implication =
			attr1: (val1, val2);
			geom: SURFACE WITH (STRAIGHTS, ARCS) VERTEX LKoord WITHOUT OVERLAPS > 0.10;
		    MANDATORY CONSTRAINT CheckImplication: attr1 == #val1 => DEFINED(geom);
		END Implication;

		CLASS Expressions =
			attr1: 0 .. 99;
			attr2: 0 .. 99;
		    MANDATORY CONSTRAINT CheckAddition: (attr1 + attr2) <= 150;
		    MANDATORY CONSTRAINT CheckMultiplication: (attr1 * attr2) <= 999;
		    MANDATORY CONSTRAINT CheckSubtraction: (attr1 - attr2) > 0;
		    MANDATORY CONSTRAINT CheckDivision: (attr1 / attr2) > 1;
		END Expressions;

	END TopicA;
END Constraints.

MODEL AdditionalModelA AT "mailto:ceis@localhost" VERSION "2023-09-05" =
	IMPORTS Constraints;
	VIEW TOPIC AdditionalTopicA =
		DEPENDS ON Constraints.TopicA;
		VIEW AdditionalClassA
			PROJECTION OF Constraints.TopicA.AdditionalConstraint;
			WHERE AdditionalConstraint->attr1==5;
			=
			ALL OF AdditionalConstraint;
			MANDATORY CONSTRAINT attr1 == attr2;
		END AdditionalClassA;
	END AdditionalTopicA;
END AdditionalModelA.